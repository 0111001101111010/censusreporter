<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <link rel="stylesheet" href="css/embed.charts.css">
    </head>
    <body>
        <div id="census-chart" class="census-chart-embed"></div>
        <script src="//cdn.jsdelivr.net/g/jquery@2.1,d3js@3.4"></script>
        <script src="http://censusreporter.org/static/js/charts.js"></script>
        <script type="text/javascript">
            var gracefulType = function(chartType) {
                window.browserWidth = document.documentElement.clientWidth;
                // convert certain chart types to more readable versions at narrow widths
                if (browserWidth <= 360) {
                    if (chartType == 'column' || chartType == 'histogram') {
                        return 'bar'
                    } else if (chartType == 'grouped_column') {
                        return 'grouped_bar'
                    }
                }
                return chartType
            }

            function receiveMessage(event) {
                embedVars = JSON.parse(event.data);
                Chart({
                    chartContainer: 'census-chart',
                    chartType: gracefulType(embedVars.chartType),
                    chartHeight: 160,
                    chartData: embedVars.chartData,
                    chartQualifier: embedVars.chartQualifier,
                    chartChartTitle: embedVars.chartChartTitle,
                    chartInitialSort: embedVars.chartInitialSort,
                    chartStatType: embedVars.chartStatType,
                    geographyData: embedVars.geographyData
                });
            }

            if (window.addEventListener) {
                window.addEventListener("message", receiveMessage, false);
            }
            else { // IE8 or earlier
                window.attachEvent("onmessage", receiveMessage, false);
            }
        </script>
    </body>
</html>